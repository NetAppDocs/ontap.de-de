---
permalink: mediator/host-maintenance-task.html 
sidebar: sidebar 
keywords: mediator, maintain, host, maintenance, package update, kernel upgrade, change hostname, change IP, self-signed certificate, self signed certificate 
summary: Warten Sie das Host-Betriebssystem für ONTAP Mediator regelmäßig, um eine optimale Leistung zu erzielen. 
---
= Warten Sie das Host-Betriebssystem für ONTAP Mediator
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Warten Sie das Host-Betriebssystem für ONTAP Mediator regelmäßig, um eine optimale Leistung zu erzielen.



== Starten Sie den Host neu

Starten Sie den Host nur neu, wenn die Cluster fehlerfrei sind.  Cluster können nicht auf Fehler reagieren, während ONTAP Mediator offline ist.  Planen Sie vor dem Neustart ein Servicefenster ein.

ONTAP Mediator wird während eines Neustarts automatisch fortgesetzt und stellt zuvor konfigurierte Beziehungen mit ONTAP Clustern wieder her.



== Updates des Host-Pakets

Aktualisieren Sie alle Bibliotheken oder Yum-Pakete außer dem Kernel.  Starten Sie den Host bei Bedarf neu, damit die Änderungen wirksam werden.  Planen Sie vor dem Neustart des Hosts ein Servicefenster ein.

Wenn Sie das `yum-utils` Paket installieren, verwenden Sie den `needs-restarting` Befehl, um zu erkennen, ob Paketänderungen einen Neustart erfordern.

Führen Sie nach der Aktualisierung der ONTAP Mediator-Abhängigkeiten einen Neustart durch, da die Änderungen nicht sofort wirksam werden.



== Kleinere Kernel-Upgrades für das Host-Betriebssystem

SCST muss für den verwendeten Kernel kompiliert werden. Zum Aktualisieren des Betriebssystems ist ein Wartungsfenster erforderlich.

.Schritte
Führen Sie die folgenden Schritte aus, um den Kernel des Host-Betriebssystems zu aktualisieren.


NOTE: Überprüfen Sie vor dem Upgrade des Kernels, ob das Betriebssystem und die ONTAP Mediator-Version kompatibel sind.  Informationen zu unterstützten Versionen finden Sie imlink:whats-new-concept.html#os-support-matrix["OS Support-Matrix"] .

. Stoppen Sie ONTAP Mediator.
. Deinstallieren Sie das SCST-Paket, siehe<<Durchführen von Host-Wartungsarbeiten>> .  (SCST bietet keinen Upgrade-Mechanismus.)
. Aktualisieren Sie das Betriebssystem, und starten Sie es neu.
. Installieren Sie das SCST-Paket erneut.
. Aktivieren Sie ONTAP Mediator erneut.




== Durchführen von Host-Wartungsarbeiten

Das Upgrade des VM-Kernels kann Kompatibilitätsprobleme mit SCST-Modulen verursachen.  Deinstallieren Sie SCST manuell und installieren Sie es erneut.



=== Schritt 1: Deinstallieren Sie SCST

Um SCST zu deinstallieren, verwenden Sie das Tar-Paket für Ihre ONTAP Mediator-Version.

.Schritte
. Laden Sie das entsprechende SCST-Paket herunter (wie in der folgenden Tabelle gezeigt) und extrahieren Sie es.
+
[cols="50,50"]
|===


| Für diese Version ... | Verwenden Sie dieses tar-Bündel... 


 a| 
ONTAP Mediator 1.10
 a| 
scst-3.9.tar.gz



 a| 
ONTAP Mediator 1.9.1
 a| 
Scst-3.8.0.tar.bz2



 a| 
ONTAP Mediator 1.9
 a| 
Scst-3.8.0.tar.bz2



 a| 
ONTAP Mediator 1.8
 a| 
Scst-3.8.0.tar.bz2



 a| 
ONTAP Mediator 1.7
 a| 
Scst-3.7.0.tar.bz2



 a| 
ONTAP Mediator 1.6
 a| 
Scst-3.7.0.tar.bz2



 a| 
ONTAP Mediator 1.5
 a| 
Scst-3.6.0.tar.bz2



 a| 
ONTAP Mediator 1.4
 a| 
Scst-3.6.0.tar.bz2



 a| 
ONTAP Mediator 1.3
 a| 
Scst-3.5.0.tar.bz2



 a| 
ONTAP Mediator 1.1
 a| 
Scst-3.4.0.tar.bz2



 a| 
ONTAP Mediator 1.0
 a| 
Scst-3.3.0.tar.bz2

|===
+
.. Greifen Sie auf das Open Source-Paket zu überlink:https://scst.sourceforge.net/downloads.html["SCST Sourceforge-Downloads"^] .
.. Wählen Sie *Freigegebene Versionen herunterladen*.
.. Extrahieren Sie das Paket auf Ihre VM.


. Führen Sie die folgenden Deinstallationsbefehle im `scst` Verzeichnis:
+
.. `systemctl stop mediator-scst`
.. `make scstadm_uninstall`
.. `make iscsi_uninstall`
.. `make usr_uninstall`
.. `make scst_uninstall`
.. `depmod`






=== Schritt 2: SCST installieren

Um SCST manuell zu installieren, benötigen Sie das SCST-Tar-Bundle, das für die installierte Version von ONTAP Mediator verwendet wird (siehe<<scst-bundle-table,SCST-Tabelle>> ).


NOTE: Führen Sie diesen Schritt aus, bevor Sie den ONTAP Mediator installieren.  Wenn die von Ihnen verwendete SCST-Version neuer ist als die mit dem ONTAP Mediator-Installationsprogramm gebündelte Version, überspringt das Installationsprogramm diesen Schritt.

. Führen Sie die folgenden Installationsbefehle im `scst` Verzeichnis:
+
.. `make 2release`
.. `make scst_install`
.. `make usr_install`
.. `make iscsi_install`
.. `make scstadm_install`
.. `depmod`
+
[NOTE]
====
Wenn Sie eine Erstinstallation durchführen und ONTAP Mediator vorinstallieren möchten, führen Sie den folgenden Befehl aus, bevor Sie mit dem nächsten Schritt fortfahren:

`mkdir -p /opt/netapp/lib/ontap_mediator/ontap_mediator/SCST_mod_keys`

====
.. `cp scst/src/certs/scst_module_key.der /opt/netapp/lib/ontap_mediator/ontap_mediator/SCST_mod_keys/`
.. `patch /etc/init.d/scst < /opt/netapp/lib/ontap_mediator/systemd/scst.patch`
+

NOTE: Wenn Sie SCST bei einer Erstinstallation vor ONTAP Mediator vorinstallieren, überspringen Sie diesen Schritt.  Das Installationsprogramm wendet relevante SCST-Patches an.



. Wenn Secure Boot aktiviert ist, führen Sie vor dem Neustart optional die folgenden Schritte aus:
+
.. Bestimmen Sie jeden Dateinamen für die `scst_vdisk` , `scst` , Und `iscsi_scst` Module:
+
....
[root@localhost ~]# modinfo -n scst_vdisk
[root@localhost ~]# modinfo -n scst
[root@localhost ~]# modinfo -n iscsi_scst
....
.. Bestimmen Sie die Kernel-Version:
+
....
[root@localhost ~]# uname -r
....
.. Signieren Sie jede Moduldatei mit dem Kernel:
+
....
[root@localhost ~]# /usr/src/kernels/<KERNEL-RELEASE>/scripts/sign-file \sha256 \
/opt/netapp/lib/ontap_mediator/ontap_mediator/SCST_mod_keys/scst_module_key.priv \
/opt/netapp/lib/ontap_mediator/ontap_mediator/SCST_mod_keys/scst_module_key.der \
_module-filename_
....
.. Installieren Sie den UEFI-Schlüssel mit der Firmware.
+
Anweisungen zur Installation des UEFI-Schlüssels finden Sie unter:

+
`/opt/netapp/lib/ontap_mediator/ontap_mediator/SCST_mod_keys/README.module-signing`

+
Der generierte UEFI-Schlüssel befindet sich unter:

+
`/opt/netapp/lib/ontap_mediator/ontap_mediator/SCST_mod_keys/scst_module_key.der`



. Starten Sie das System neu:
+
`reboot`





== Host ändert sich zum Hostnamen oder IP

.Über diese Aufgabe
* Führen Sie diese Aufgabe auf dem Linux-Host aus, auf dem Sie ONTAP Mediator installiert haben.
* Führen Sie diese Aufgabe nur aus, wenn die selbstsignierten Zertifikate veraltet sind, weil sich der Hostname oder die IP-Adresse nach der Installation von ONTAP Mediator geändert hat.
* Nachdem das temporäre selbstsignierte Zertifikat durch ein vertrauenswürdiges Drittanbieterzertifikat ersetzt wurde, verwenden Sie diese Aufgabe _nicht_, um ein Zertifikat neu zu generieren.  Wenn Sie kein selbstsigniertes Zertifikat besitzen, können Sie dieses Verfahren nicht verwenden.


.Schritt
Erstellen Sie ein temporäres selbstsigniertes Zertifikat für den aktuellen Host:

. Starten Sie ONTAP Mediator neu:
+
`./make_self_signed_certs.sh overwrite`

+
[listing]
----
[root@xyz000123456 ~]# cd /opt/netapp/lib/ontap_mediator/ontap_mediator/server_config
[root@xyz000123456 server_config]# ./make_self_signed_certs.sh overwrite

Adding Subject Alternative Names to the self-signed server certificate
#
# OpenSSL example configuration file.
Generating self-signed certificates
Generating RSA private key, 4096 bit long modulus (2 primes)
..................................................................................................................................................................++++
........................................................++++
e is 65537 (0x010001)
Generating a RSA private key
................................................++++
.............................................................................................................................................++++
writing new private key to 'ontap_mediator_server.key'
-----
Signature ok
subject=C = US, ST = California, L = San Jose, O = "NetApp, Inc.", OU = ONTAP Core Software, CN = ONTAP Mediator, emailAddress = support@netapp.com
Getting CA Private Key

[root@xyz000123456 server_config]# systemctl restart ontap_mediator
----

